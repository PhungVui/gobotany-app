{% extends "simplekey/_base.html" %}
{% load thumbnail %}
{% load simplekey_extras %}

{% block title %}
Family: {{ family.name }} {% if common_name %}({{ common_name }}){% endif %}{% endblock %}

{% block body %}
    <body id="family" class="claro app family">
        {% include "simplekey/_header.html" %}

        <div class="content">
            <div class="container">
                <div id="main">
                    <h2>Family: {{ family.name }}</h2>
                    <h3>{% if common_name %}{{ common_name }}{% endif %}</h3>
                    <p class="description">
                    {% if item.description %}
                        {{ item.description }}
                    {% else %}
                        TO DO: Add description in the database.
                        This is a placeholder description.
                        (Test glossary highlighting here with a few terms,
                        such as abaxial, berry, creeping, fruit and
                        perennial.)
                    {% endif %}
                    </p>
                    
                    <div class="familypics">
                        {% for drawing in family_drawings %}
                            <div>
                                <a rel="shadowbox"
                                    href="{{ drawing.image.url }}">
                                    <img class="map"
                                        src="{{ drawing.image.thumbnail.absolute_url }}"
                                        alt="{{ drawing.alt }}"></a>
                                <p>{{ drawing.alt }}</p>
                                <a class="enlarge" rel="shadowbox"
                                    href="{{ drawing.image.url }}">
                                    <img class="zoom"
                                    src="/static/images/icons/zoom.png"></a>
                            </div>
                        {% endfor %}
                    </div>

                    <h4>Genera in this Plant Family:</h4>
                    <ul class="genera">
                    {% for genus in family.genera.all %}
                        <li><em><a href="{% url simplekey-genus genus.slug %}"
                        >{{ genus.name }}</a></em></li>
                    {% endfor %}
                    </ul>

                    <a class="family-genera-btn" href="#"></a>

                </div>
                <div id="sidebar" style="height: 634px;">
                    {% include "simplekey/_sidebar_items.html" %}
                </div>
                <div class="clearit"></div>
            </div>
        </div>

        {% include "simplekey/_footer.html" %}

        {% include "simplekey/_script_constants.html" %}

        <script>
            {% include "simplekey/partner_site_inline_js.html" %}
        </script>
        
        {% block js_bottom %}
        <script>
        API_URL = '{% url api-base %}';
        dojo.require('gobotany.sk.family');
        dojo.addOnLoad(function() {
            gobotany.sk.family.init('{{ family.slug }}');
        });
        </script>
        {% endblock %}
    </body>
{% endblock %}

{# TODO: remove this code once it is confirmed that it will not be needed #}
{% block content %}
  <div id="family">
    <div id="images">
      <h3>Images</h3>
      <p>
          {% if family_images %}
              {% for i in family_images %}
                  {% if forloop.first %}
                      <img src="{{ i.image.url }}">
                  {% endif %}
              {% endfor %}
          {% else %}
              <img src="/static/nothing.png" alt="not available">
          {% endif %}
      </p>
      <p class="nav"><a>&lt; prev</a> <span>? of ?</span>
          <a>next &gt;</a></p>
    </div>

    <div id="info">
      <h3>Description</h3>
      <p>{% if family.description %}
             {{ family.description }}
         {% else %}
             This is a placeholder description.
             (Test glossary highlighting with the term isophyllous here.)
         {% endif %}</p>

      <h3>Genera</h3>
      <ul class="Genera">
        {% for genus in family.genera.all %}
        <li><em><a href="{% url simplekey-genus genus.slug %}"
                   >{{ genus.name }}</a></em></li>
        {% endfor %}
      </ul>

      <h3>Species</h3>
      <ul class="Species">
        {% for genus in family.genera.all %}
        <li><em>{{ genus.name }}</em>:
            <ul>
                {% for species in family.taxa.all %}
                    {% ifequal genus.name|cut:' ' species.genus|cut:' ' %}
                        <li><a href="{% url simplekey-species species.genus.slug species.epithet %}"
                        ><em>{{ species.genus|make_list|first }}. {{ species.epithet }}</em></a></li>
                    {% endifequal %}    
                {% endfor %}
            </ul>
        </li>
        {% endfor %}
      </ul>
    </div>

    <div id="drawings">
      {% if item_drawings %}
      <ul>
        {% for i in item_drawings %}
        <li>
          <div class="ItemDrawing">
            {{ i.image.thumbnail_tag }}
          </div>
         <h4>{{ i.alt }}</h4>
        </li>
        {% endfor %}
      </ul>
      {% else %}
          {# temporary dummy presentation until we have data #}
          <div>
              <img src="/media/character-value/basal-lobes-absent-ap.gif" alt="placeholder image 1">
              <p>placeholder caption 1</p>
          </div>
          <div>
              <img src="/static/nothing.png" alt="placeholder image 2">
              <p>placeholder caption 2</p>
          </div>
          <div>
              <img src="/static/nothing.png" alt="placeholder image 3">
              <p>placeholder caption 3</p>
          </div>
      {% endif %}
    </div>
  </div>
{% endblock %}

