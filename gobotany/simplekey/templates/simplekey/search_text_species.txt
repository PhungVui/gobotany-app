{% load simplekey_extras %}

{{ object.scientific_name }} {{ object.taxonomic_authority }}.

{% for common_name in object.common_names.all %}{% if not forloop.first %}, {% endif %}
              {{ common_name }}{% endfor %}.

{% for pile in object.get_piles_with_pilegroups %}
    {{ pile.pilegroup.name }} {{ pile.name }}
{% endfor %}

Description: {{ object.description }}.

Habitat: {{ object.get_habitats|join:", " }}

{# At this point the species page has a Characteristics section. This is #}
{# just an excerpt of the All Characteristics section further down the   #}
{# page, so there is probably not a need to repeat it here.              #}

{% with object.lookalikes.all as all_lookalikes %}
  {% if all_lookalikes|length > 0 %}
    Sometimes Confused With:
    {% for lookalike in all_lookalikes %}
        {{ lookalike.lookalike_characteristic }}:
        {{ lookalike.lookalike_scientific_name }}
    {% endfor %}
  {% endif %}
{% endwith %}

Native to North America?
{% if object.north_american_native == None %}
{% else %}
    {% if not object.north_american_native %}
        No
    {% else %}
        {% if object.north_american_native %}
            Yes
            {% if object.north_american_introduced %}
                and no (some introduced)
            {% endif %}
        {% endif %}
    {% endif %}
{% endif %}

Distribution and Conservation Status:
    Connecticut: {{ object.conservation_status_ct }}
    Maine: {{ object.conservation_status_me }}
    Massachusetts: {{ object.conservation_status_ma }}
    New Hampshire: {{ object.conservation_status_nh }}
    Rhode Island: {{ object.conservation_status_ri }}
    Vermont: {{ object.conservation_status_vt }}

Wetland Status: {{ object.wetland_status_text }}
{% if object.wetland_status_text != 'not classified' %}
    (Wetland indicator code: {{ object.wetland_status_code }})
{% endif %}

All Characteristics:
{# TODO: may want to add brief characteristics, and group full list by character group, like species page. #}
{% for character_value in object.get_character_values_with_characters.all %}
  {% with character_value.character as character %}
    {{ character.friendly_name }}:
    {% if character.value_type == 'TEXT' %}
        {% if character_value.friendly_text %}
            {{ character_value.friendly_text }}.
        {% else %}
            {{ character_value.value_str }}.
        {% endif %}
    {% else %}
        {{ character_value.value_min }}
        {{ character.unit }}â€“{{ character_value.value_max }}
        {{ character.unit }}.
    {% endif %}
  {% endwith %}
{% endfor %}

{# Distribution by County: TODO: perhaps add a text equivalent if it'd help to search by county. #}

Folklore & History:
{% if object.factoid|length > 0 %}
    {{ object.factoid }}
{% else %}
    N/A
{% endif %}

Classification:
    Family: {{ object.family.name }}
    Genus: {{ object.genus_name }}
    Species: {{ object.scientific_name }}
    Full name: {{ object.scientific_name }} {{ object.taxonomic_authority }}

{% with object.synonyms.all as all_synonyms %}
  {% if all_synonyms|length > 0 %}
    Also Known As:
    {% for synonym in all_synonyms %}
        {{ synonym.scientific_name }}{% if not forloop.last %},{% endif %}
    {% endfor %}
  {% endif %}
{% endwith %}

{% if object.variety_notes %}
    Notes on Subspecies and Varieties:
    {{ object.variety_notes|safe }}
{% endif %}

--
{# Index the scientific name and any common names many more times to #}
{# boost ranking. This will be hidden from the user because it is    #}
{# inside double-dash markers. #}
{% with object.scientific_name as the_name %}
    {% for i in 600|get_range %}
        {{ the_name }}
    {% endfor %}
{% endwith %}
{% for common_name in object.common_names.all %}
    {% for i in 600|get_range %}
        {{ common_name }}
    {% endfor %}
{% endfor %}
--
