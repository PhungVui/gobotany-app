{% extends "simplekey/_new_base.html" %}
{% load verbatim %}

{% block title %}{{ subgroup_results_page.title }}{% endblock %}

{% block js_require %}
    original_location_hash = window.location.hash; // for results_overlay.js
    var args = {
        pile_slug: '{{ pile.slug }}'
    };
    require(['simplekey/results'], function(results) {
        results.results_page_init(args);
    });
{% endblock %}

{% block body_attributes %}id="plant-id-3" class="app"{% endblock %}

{% block body_content %}
    {% include "simplekey/_header.html" %}

    {% include "simplekey/_results_modal_dialogs.html" %}

    <div class="content">
        <div class="container">
            <div id="main">
                <div id="breadcrumb">
                    <p>You are here: <a href="{% url simplekey %}">Simple Key</a>
                    &gt; <a href="{% url simplekey-pilegroup pilegroup.slug %}"
                        >{{ pilegroup.friendly_title|lower|capfirst }}</a>
                    &gt; <span>{{ pile.friendly_title }}</span></p>
                </div>

                <h2>{{ subgroup_results_page.main_heading|lower|capfirst }}</h2>
                
                <div class="working-area" aria-live="polite" 
                    aria-relevant="additions removals">
                    <img class="arrow" alt=""
                        src="/static/images/layout/working-area-arrow.png">
                    <a href="#" class="close"></a>

                    <h4></h4>
                    <div>
                        <div class="info">
                            <div class="dld"></div>
                            <div class="hint"></div>
                            <div class="values"></div>
                            <div class="actions">
                              <a class="apply-btn" href="#">Apply</a>
                            </div>
                        </div>
                    </div>
                    <div class="clearit"></div>
                </div>

                <h3 class="species-count-heading">
                  <span>
                    {% handlebars %}
                      <span class="species-count"
                            >{{App3.matching_species_count}}</span>
                      matching species
                    {% endhandlebars %}
                  </span>
                </h3>

                <div id="results-tabs">
                  {% handlebars 'species-view-tabs' %}
                    <li><a {{bindAttr class="App3.show_grid:current"}}
                           {{action choose_grid_view}}>Photos</a></li>
                    <li><a {{bindAttr class="App3.show_list:current"}}
                           {{action choose_list_view}}>List</a></li>
                  {% endhandlebars %}
                </div>

                <div class="clearit"></div>

                <div>
                  {% handlebars %}
                    <form id="results-display"
                          {{bindAttr class="App3.show_list:hidden"}}>
                        <img class="icon" alt=""
                            src="/static/images/icons/show-me.png">
                        <label for="image-types">Show photos of:</label>
                          {{view Ember.Select viewName="select"
                            elementId="image-types"
                            contentBinding="App3.image_types"
                            optionLabelPath="content"
                            optionValuePath="content"
                            selectionBinding="App3.image_type"}}
                    </form>
                  {% endhandlebars %}
                </div>
                <div class="clearit"></div>

                <div class="plant-list">
                    <div class="wait"></div>
                </div>

                {% handlebars 'species-view-toggle' %}
                  <a {{action "switch_species_view"}}>
                    See
                    {{#if App3.show_list}}photos for{{else}}a list of{{/if}}
                    all
                    <span class="species-count"
                          >{{App3.matching_species_count}}</span>
                    matching species.
                  </a>
                {% endhandlebars %}

            </div>

            <div id="sidebar" class="tinted">
                <div class="section instructions">
                    <h5>Pick a question from this
                        scrollable list:</h5>
                </div>
                <div class="scroll">
                  <div class="loading">Loading questions…</div>
                  <div id="questions-go-here"></div>
                </div>

                <div class="section">
                    <p class="get-more">
                        <a class="get-choices">Get More Questions</a>
                        Add a few more questions for narrowing your
                        matching species.</p>
                </div>


                <div class="section">
                    <div class="already-know">
                        <h6>Already know the family or genus?</h6>
                        <label>Family:</label>
                        {% handlebars %}
                          {{view Ember.Select viewName="select"
                            elementId="families"
                            contentBinding="App3.family_choices"
                            selectionBinding="App3.family_value"}}
                          <button id="family_clear">Clear</button>
                        {% endhandlebars %}
                        <label>Genus:</label>
                        {% handlebars %}
                          {{view Ember.Select viewName="select"
                            elementId="genera"
                            contentBinding="App3.genus_choices"
                            selectionBinding="App3.genus_value"}}
                          <button id="genus_clear">Clear<button>
                        {% endhandlebars %}
                    </div>
                </div>
        
                <div class="section">
                    <h5 class="left help">Start Over:</h5>
                    <a class="clear-all-btn left">Clear All</a>
                    <div class="clearit"></div>
                </div>
        
                <div class="section">
                    <h5 class="left help">Need Help?</h5>
                    <a href="{% url simplekey-help-start %}"
                        class="get-help-btn left">Get Help</a>
                    <div class="clearit"></div>
                </div>
                
            </div>

            <div class="clearit"></div>
        </div>
    </div>

    {# TODO: eventually move elsewhere #}
    {% include "simplekey/_partner_site_js.html" %}

    <div id="intro-overlay">
       <div class="number-of-species">
            <h1><span class="number">…</span> possible matches</h1>
        </div>
        <div class="number-of-questions">
            <h1>Answer questions here</h1>
        </div>
        <div class="continue">
            <h1>Continue</h1>
        </div>
    </div>
{% endblock %}

{% block ember_templates %}
{% handlebars 'filter-view' %}
  <a class="option">
    <span class="name">{{view.filter.info.friendly_name}}?</span>
    <span class="value">{{view.display_value}}</span>
  </a>
  {{#if view.filter.value}}
  <a class="clear-filter" {{action "clear"}}>Clear</a>
  {{/if}}
{% endhandlebars %}
{% endblock %}
