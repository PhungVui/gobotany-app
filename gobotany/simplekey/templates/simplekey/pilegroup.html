{% extends "simplekey/_new_base.html" %}
{% load simplekey_extras %}

{% block title %}{{ subgroups_list_page.title }}{% endblock %}

{% block body_attributes %}id="plant-id-2" class="app {{ key|title|lower }}"{% endblock %}

{% block js_top %}
    {# TODO: eventually move elsewhere #}
    {% include "simplekey/_partner_site_js.html" %}
{% endblock %}

{% block js_require %}
    require(['simplekey/simple']);
{% endblock %}

{% block body_content %}
    {% include "simplekey/_header.html" %}

    <div class="content">
        <div class="container">
            <div id="main">
                <div id="breadcrumb">
                    <p>You are here:
                    <a href="{% url level1 key %}">{{ key|title }} Key</a>
                    &gt; <span>{{ pilegroup.friendly_title|lower|capfirst }}</span></p>
                </div>
                
                <h2>{{ subgroups_list_page.main_heading }}</h2>

                <p class="tip">Please go through the subgroups in order.</p>

                <div class="clearit"></div>

                {% for pile, pile_images, pile_url in piles %}
                    <div class="list-item{% if forloop.last %} last{% endif %}">
                        <div class="img-gallery">
                            <div class="frame"></div>
                            <div class="img-container">
                                <div class="images">
                                    {% for content_image in pile_images %}
                                        {% with content_image as i %}
                                            {% with i.creator as photographer %}
                                            <a href="{{ i.image_medium }}"
                                                rel="shadowbox[{{ pile.slug }}]"
                                                title="{% photo_credit i i.scientific_name %}">
                                                <img src="{{ i.thumb_large }}"
                                                    alt="{% photo_credit i i.scientific_name %}">
                                            </a>
                                            {% endwith %}
                                        {% endwith %}
                                    {% endfor %}
                                </div>
                            </div>
                            <div class="controls">
                                <a class="prev">Prev</a>
                                <a class="next">Next</a>
                            </div>
                        </div>
                        <div class="details">
                            <h3>{{ pile.friendly_title|lower|capfirst }} <span>{{ pile.friendly_name|capfirst }}</span></h3>
                            <p class="key-char">
                                <span class="section-title">Key Characteristics</span>
                                {{ pile.key_characteristics|removetags:"div ul li"|safe }}
                            </p>
                            <p class="exceptions">
                                <span class="section-title">Exceptions</span>
                                {{ pile.notable_exceptions|removetags:"div ul li"|safe }}
                            </p>
                            {% if pile.youtube_id %}
                            <p class="vid">
                                {% with pile.youtube_id as youtube_id %}
                                {% include "simplekey/_simplekey_video_link.html" with item_type="subgroup" %}
                                {% endwith %}
                            </p>
                            {% endif %}
                            <a class="plant-in-subgroup" href="{{ pile_url }}">My plant is in this subgroup</a>
                        </div>
                        <div class="clearit"></div>
                    </div>
                {% endfor %}

                {% include "simplekey/_plant_not_in_subgroup.html" %}

            </div>

            <div id="sidebar">
                {% include "simplekey/_sidebar_items.html" %}
            </div>

            <div class="clearit"></div>

        </div>
    </div>
{% endblock %}
